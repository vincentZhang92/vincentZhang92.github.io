<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>高级功能 | VincentZhang的笔记</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content="Just playing around">
    
    <link rel="preload" href="/assets/css/0.styles.e4d8b86b.css" as="style"><link rel="preload" href="/assets/js/app.b0589c77.js" as="script"><link rel="preload" href="/assets/js/2.c0366890.js" as="script"><link rel="preload" href="/assets/js/20.ef8e6329.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.e4d8b86b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.svg" alt="VincentZhang的笔记" class="logo"> <span class="site-name can-hide">VincentZhang的笔记</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/rollup/" class="nav-link router-link-active">
  Rollup
</a></div><div class="nav-item"><a href="/codeLint/eslint/" class="nav-link">
  代码规范
</a></div> <a href="https://github.com/vincentZhang92/vincentZhang92.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/rollup/" class="nav-link router-link-active">
  Rollup
</a></div><div class="nav-item"><a href="/codeLint/eslint/" class="nav-link">
  代码规范
</a></div> <a href="https://github.com/vincentZhang92/vincentZhang92.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/rollup/" aria-current="page" class="sidebar-link">介绍</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>配置项</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rollup/options/" aria-current="page" class="sidebar-link">配置项列表</a></li><li><a href="/rollup/options/coreFunctionality.html" class="sidebar-link">核心配置</a></li><li><a href="/rollup/options/advancedFunctionality.html" aria-current="page" class="active sidebar-link">高级功能</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/rollup/options/advancedFunctionality.html#cache" class="sidebar-link">cache</a></li><li class="sidebar-sub-header"><a href="/rollup/options/advancedFunctionality.html#makeabsoluteexternalsrelative" class="sidebar-link">makeAbsoluteExternalsRelative</a></li><li class="sidebar-sub-header"><a href="/rollup/options/advancedFunctionality.html#maxparallelfilereads" class="sidebar-link">maxParallelFileReads</a></li><li class="sidebar-sub-header"><a href="/rollup/options/advancedFunctionality.html#onwarn" class="sidebar-link">onwarn</a></li><li class="sidebar-sub-header"><a href="/rollup/options/advancedFunctionality.html#output-assetfilenames" class="sidebar-link">output.assetFileNames</a></li><li class="sidebar-sub-header"><a href="/rollup/options/advancedFunctionality.html#output-banner-output-footer" class="sidebar-link">output.banner/output.footer</a></li><li class="sidebar-sub-header"><a href="/rollup/options/advancedFunctionality.html#output-chunkfilenames" class="sidebar-link">output.chunkFileNames</a></li><li class="sidebar-sub-header"><a href="/rollup/options/advancedFunctionality.html#output-compact" class="sidebar-link">output.compact</a></li><li class="sidebar-sub-header"><a href="/rollup/options/advancedFunctionality.html#output-entryfilenames" class="sidebar-link">output.entryFileNames</a></li><li class="sidebar-sub-header"><a href="/rollup/options/advancedFunctionality.html#output-extend" class="sidebar-link">output.extend</a></li><li class="sidebar-sub-header"><a href="/rollup/options/advancedFunctionality.html#output-generatedcode" class="sidebar-link">output.generatedCode</a></li><li class="sidebar-sub-header"><a href="/rollup/options/advancedFunctionality.html#output-hoisttransitiveimports" class="sidebar-link">output.hoistTransitiveImports</a></li><li class="sidebar-sub-header"><a href="/rollup/options/advancedFunctionality.html#output-inlinedynamicimports" class="sidebar-link">output.inlineDynamicImports</a></li><li class="sidebar-sub-header"><a href="/rollup/options/advancedFunctionality.html#output-interop" class="sidebar-link">output.interop</a></li><li class="sidebar-sub-header"><a href="/rollup/options/advancedFunctionality.html#output-intro-output-outro" class="sidebar-link">output.intro/output.outro</a></li><li class="sidebar-sub-header"><a href="/rollup/options/advancedFunctionality.html#output-manualchunks" class="sidebar-link">output.manualChunks</a></li><li class="sidebar-sub-header"><a href="/rollup/options/advancedFunctionality.html#output-minifyinternalexports" class="sidebar-link">output.minifyInternalExports</a></li><li class="sidebar-sub-header"><a href="/rollup/options/advancedFunctionality.html#output-paths" class="sidebar-link">output.paths</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="高级功能"><a href="#高级功能" class="header-anchor">#</a> 高级功能</h1> <h2 id="cache"><a href="#cache" class="header-anchor">#</a> cache</h2> <p>类型: <code>RollupCache | false</code></p> <p>上次构建时的<code>cache</code>属性。使用它来加速在监视模式下的后续构建——Rollup 只会重新分析已更改的模块。将此选项显式地设置为<code>false</code>将防止在 bundle 上生成<code>cache</code>属性，也将禁用插件的缓存。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> rollup <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'rollup'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> cache<span class="token punctuation">;</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">buildWithCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> bundle <span class="token operator">=</span> <span class="token keyword">await</span> rollup<span class="token punctuation">.</span><span class="token function">rollup</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    cache <span class="token comment">// is ignored if falsy</span>
    <span class="token comment">// ... other input options</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  cache <span class="token operator">=</span> bundle<span class="token punctuation">.</span>cache<span class="token punctuation">;</span> <span class="token comment">// store the cache object of the previous build</span>
  <span class="token keyword">return</span> bundle<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">buildWithCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">bundle</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// ... do something with the bundle</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">buildWithCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// will use the cache of the previous build</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">bundle</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// ... do something with the bundle</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="makeabsoluteexternalsrelative"><a href="#makeabsoluteexternalsrelative" class="header-anchor">#</a> makeAbsoluteExternalsRelative</h2> <p>类型: <code>boolean | &quot;ifRelativeSource&quot;</code></p> <p>命令: <code>--makeAbsoluteExternalsRelative/--no-makeAbsoluteExternalsRelative</code></p> <p>默认：<code>true</code></p> <p>确定输出中的绝对外部路径是否应该转换为相对路径。这不仅适用于源文件中的绝对路径，也适用于插件或 Rollup 核心解析为绝对路径的路径。</p> <p>值为<code>true</code>时，像<code>import &quot;/Users/Rollup/project/relative.js&quot;</code>这样的外部导入将被转换为一个相对路径。当将绝对路径转换为相对路径时，Rollup 不会考虑<code>file</code>或<code>dir</code>选项，因为这些选项可能不会出现，例如在使用 JavaScript API 构建时。相反，它假设生成的包的根位于包中包含的所有模块的公共共享父目录。假设所有模块的公共父目录是<code>“/Users/Rollup/project”</code>，上面的导入可能会在输出中转换为<code>import“./relative.js”</code>。如果通过选择<code>chunkFileNames: &quot;chunks/[name].js&quot;</code>，输出块本身嵌套在子目录中，则导入为<code>&quot;../relative.js&quot;</code>。</p> <p>如前所述，这也适用于原始的相对导入，如<code>import &quot;./relative.js&quot;</code>，它们在被<a href="/rollup/options/coreFunctionality.html#external">external</a>选项标记为外部之前被解析为绝对路径。</p> <p>一个常见的问题是，这种机制也适用于<code>import &quot;/absolute.js'&quot;</code>之类的导入，导致输出中出现意外的相对路径。</p> <p>对于这种情况，选择<code>“ifRelativeSource”</code>将检查原始导入是否为相对导入，然后在输出中将其转换为相对导入。选择<code>false</code>将在输出中保持所有路径为绝对路径。</p> <div class="custom-block tip"><p class="custom-block-title">注意</p> <p>当使用<a href="/rollup/options/coreFunctionality.html#external">external</a>选项将一个相对路径直接标记为“external”时，那么它在输出中将是相同的相对路径。当它首先通过插件或 Rollup 核心进行解析，然后标记为外部时，将应用上述逻辑。</p></div> <h2 id="maxparallelfilereads"><a href="#maxparallelfilereads" class="header-anchor">#</a> maxParallelFileReads</h2> <p>类型: <code>number</code></p> <p>命令: <code>--maxParallelFileReads &lt;number&gt;</code></p> <p>默认：<code>20</code></p> <p>限制汇总读取模块时并行打开的文件数量。如果没有限制或有足够高的值，构建可能会因为“EMFILE: too many open files”而失败。这取决于操作系统允许打开多少个文件句柄。</p> <h2 id="onwarn"><a href="#onwarn" class="header-anchor">#</a> onwarn</h2> <p>类型: <code>(warning: RollupWarning, defaultHandler: (warning: string | RollupWarning) =&gt; void) =&gt; void</code></p> <p>拦截警告消息的函数。如果没有提供，警告将被去重并打印到控制台。当使用 <a href="https://rollupjs.org/guide/en/#--silent" target="_blank" rel="noopener noreferrer">——silent<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> CLI 选项时，此处理程序是获得警告通知的惟一方法。</p> <p>该函数接收两个参数:警告对象和默认处理程序。警告对象至少有一个<code>code</code>和一个<code>message</code>属性，允许您控制如何处理不同类型的警告。根据警告的类型添加其他属性。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// rollup.config.js</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span><span class="token punctuation">,</span>
  <span class="token function">onwarn</span> <span class="token punctuation">(</span><span class="token parameter">warning<span class="token punctuation">,</span> warn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// skip certain warnings</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>warning<span class="token punctuation">.</span>code <span class="token operator">===</span> <span class="token string">'UNUSED_EXTERNAL_IMPORT'</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>

    <span class="token comment">// throw on others</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>warning<span class="token punctuation">.</span>code <span class="token operator">===</span> <span class="token string">'NON_EXISTENT_EXPORT'</span><span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span>warning<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Use default for everything else</span>
    <span class="token function">warn</span><span class="token punctuation">(</span>warning<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>许多警告也有一个<code>loc</code>属性和一个允许你定位警告来源的<code>frame</code>:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// rollup.config.js</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span><span class="token punctuation">,</span>
  <span class="token function">onwarn</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> loc<span class="token punctuation">,</span> frame<span class="token punctuation">,</span> message <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>loc<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>loc<span class="token punctuation">.</span>file<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> (</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>loc<span class="token punctuation">.</span>line<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>loc<span class="token punctuation">.</span>column<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">) </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>message<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>frame<span class="token punctuation">)</span> console<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span>frame<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="output-assetfilenames"><a href="#output-assetfilenames" class="header-anchor">#</a> output.assetFileNames</h2> <p>类型: <code>string | ((assetInfo: AssetInfo) =&gt; string)</code></p> <p>命令: <code>--assetFileNames &lt;pattern&gt;</code></p> <p>默认：<code>assets/[name]-[hash][extname]</code></p> <p>对构建输出中的 assets 进行自定义命名，可以直接传递模式，也可以传递一个返回模式的函数(每个 asset 都会执行该函数)。模式支持以下占位符:</p> <ul><li><code>[extname]</code>: 资产的文件扩展名，包含前导点，例如<code>.css</code>。</li> <li><code>[ext]</code>: 不带前导点的文件扩展名，例如 css。</li> <li><code>[hash]</code>: 基于资产名称和内容的哈希。</li> <li><code>[name]</code>: 资产文件名，不包含扩展名。</li></ul> <p>正斜杠 <code>/</code> 可以用于将文件放在子目录中。当使用函数时，<code>assetInfo</code>是<a href="https://rollupjs.org/guide/en/#generatebundle" target="_blank" rel="noopener noreferrer">generateBundle<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>中不带<code>fileName</code>的函数的简化版本。也可以查看<a href="#output-chunkfilenames">output.chunkFileNames</a>, <a href="#output-entryfilenames">output.entryFileNames</a></p> <h2 id="output-banner-output-footer"><a href="#output-banner-output-footer" class="header-anchor">#</a> output.banner/output.footer</h2> <p>类型: <code>string | (() =&gt; string | Promise&lt;string&gt;)</code></p> <p>命令: <code>--banner/--footer &lt;text&gt;</code></p> <p>要在 bundle 前面/后面追加的字符串。你也可以提供一个函数来返回一个解析为字符串的<code>Promise</code>来异步地生成它(注意:<code>banner</code>和<code>footer</code>选项不会破坏 sourcemaps)。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// rollup.config.js</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span><span class="token punctuation">,</span>
  <span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span><span class="token punctuation">,</span>
    <span class="token literal-property property">banner</span><span class="token operator">:</span> <span class="token string">'/* my-library version '</span> <span class="token operator">+</span> version <span class="token operator">+</span> <span class="token string">' */'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">footer</span><span class="token operator">:</span> <span class="token string">'/* follow me on Twitter! @rich_harris */'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>也可以查看<a href="#output-intro-output-outro">output.intro/output.outro</a></p> <h2 id="output-chunkfilenames"><a href="#output-chunkfilenames" class="header-anchor">#</a> output.chunkFileNames</h2> <p>类型: <code>string | ((chunkInfo: ChunkInfo) =&gt; string)</code></p> <p>命令: <code>--chunkFileNames &lt;pattern&gt;</code></p> <p>默认：<code>[name]-[hash].js</code></p> <p>当代码拆分时用于命名共享块的模式，可以是字符串也可以是一个返回此类模式的函数(该函数会被每个块调用)。模式支持以下占位符:</p> <ul><li><code>[format]</code>: 在输出选项中定义的渲染格式，例如<code>es</code>或<code>cjs</code>。</li> <li><code>[hash]</code>: 基于数据块及其所有依赖项的内容的哈希。</li> <li><code>[name]</code>: 块的名称。这可以通过 <a href="#output-manualchunks">output.manualChunks</a> 选项或当代码块被插件通过 <a href="https://rollupjs.org/guide/en/#thisemitfile" target="_blank" rel="noopener noreferrer">this.emitFile<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 创建时被显式地设置。否则，它将从块内容派生。</li></ul> <p>正斜杠<code>/</code>可以用于将文件放在子目录中。当使用函数时，<code>assetInfo</code>是<a href="https://rollupjs.org/guide/en/#generatebundle" target="_blank" rel="noopener noreferrer">generateBundle<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>中不带<code>fileName</code>的函数的简化版本。也可以查看<a href="#output-assetfilenames">output.assetFileNames</a>, <a href="#output-entryfilenames">output.entryFileNames</a>。</p> <h2 id="output-compact"><a href="#output-compact" class="header-anchor">#</a> output.compact</h2> <p>类型: <code>boolean</code></p> <p>命令: <code>--compact/--no-compact</code></p> <p>默认：<code>false</code></p> <p>这将压缩由 rollup 生成的包装器代码。注意，这不会影响用户编写的代码。这个选项在绑定预压缩的代码时很有用。</p> <h2 id="output-entryfilenames"><a href="#output-entryfilenames" class="header-anchor">#</a> output.entryFileNames</h2> <p>类型: <code>string | ((chunkInfo: ChunkInfo) =&gt; string)</code></p> <p>命令: <code>--entryFileNames &lt;pattern&gt;</code></p> <p>默认：<code>[name].js</code></p> <p>用于对被入口点创建的代码块进行命名的模式，该模式可以是字符串，也可以是被每个入口代码块调用并返回此类模式的函数。模式支持以下占位符:</p> <ul><li><code>[format]</code>: 在输出选项中定义的渲染格式，例如<code>es</code>或<code>cjs</code>。</li> <li><code>[hash]</code>: 基于入口点的内容及其所有依赖项的内容的哈希。</li> <li><code>[name]</code>: 入口点的文件名(不带扩展名)，除非输入的对象形式用于定义不同的名称。</li></ul> <p>正斜杠 <code>/</code> 可以用于将文件放在子目录中。当使用函数时，<code>assetInfo</code>是<a href="https://rollupjs.org/guide/en/#generatebundle" target="_blank" rel="noopener noreferrer">generateBundle<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>中不带<code>fileName</code>的函数的简化版本。也可以查看<a href="#output-assetfilenames">output.assetFileNames</a>, <a href="#output-chunkfilenames">output.chunkFileNames</a>.</p> <p>当设置 <a href="">output.preserveModules</a> 选项时这个模式也可以使用。这里有一组不同的占位符:</p> <ul><li><code>[format]</code>: 输出选项中定义的呈现格式。</li> <li><code>[name]</code>: 文件名(不带扩展名)。</li> <li><code>[ext]</code>: 文件扩展名。</li> <li><code>[extname]</code>: 文件扩展名，前缀为 <code>.</code>，如果非空时。</li> <li><code>[assetExtname]</code>: 文件扩展名，前缀为<code>.</code> 如果它非空且它不是<code>js</code>, <code>jsx</code>, <code>ts</code>或<code>tsx</code>之一。</li></ul> <h2 id="output-extend"><a href="#output-extend" class="header-anchor">#</a> output.extend</h2> <p>类型: <code>boolean</code></p> <p>命令: <code>--extend/--no-extend</code></p> <p>默认：<code>false</code></p> <p>是否扩展在<code>umd</code>或<code>iife</code>格式下由<code>name</code>属性定义的全局变量。当为<code>true</code>时，全局变量将定义为<code>(global.name = global.name ||{})</code>。 当为<code>false</code>时，由<code>name</code>定义的全局将被覆盖，就像<code>(global.name ={})</code>一样。</p> <h2 id="output-generatedcode"><a href="#output-generatedcode" class="header-anchor">#</a> output.generatedCode</h2> <p>类型: <code>&quot;es5&quot; | &quot;es2015&quot; | { arrowFunctions?: boolean, constBindings?: boolean, objectShorthand?: boolean, preset?: &quot;es5&quot; | &quot;es2015&quot;, reservedNamesAsProps?: boolean, symbols?: boolean }</code></p> <p>命令: <code>--generatedCode &lt;preset&gt;</code></p> <p>默认：<code>es5</code></p> <p>Rollup 可以在生成的代码中安全地使用哪些语言特性。这不会转换任何用户代码，只会更改 Rollup 在包装器和 helper 中使用的代码。你可以选择一个预设:</p> <ul><li><code>&quot;es5&quot;</code>: 不要使用像箭头函数这样的 ES2015+特性，但不要引用用作道具的保留名称。</li> <li><code>&quot;es2015&quot;</code>: 使用 es2015 之前的任何 JavaScript 特性。</li></ul> <h3 id="output-generatedcode-arrowfunctions"><a href="#output-generatedcode-arrowfunctions" class="header-anchor">#</a> output.generatedCode.arrowFunctions</h3> <p>类型: <code>boolean</code></p> <p>命令: <code>--generatedCode.arrowFunctions/--no-generatedCode.arrowFunctions</code></p> <p>默认：<code>false</code></p> <p>是否为自动生成的代码段使用箭头函数。请注意，在某些地方，如模块包装器，Rollup 将继续使用括号包装的常规函数，就像在一些 JavaScript 引擎中一样，这将提供<a href="https://v8.dev/blog/preparser#pife" target="_blank" rel="noopener noreferrer">明显更好的性能<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <h3 id="output-generatedcode-constbindings"><a href="#output-generatedcode-constbindings" class="header-anchor">#</a> output.generatedCode.constBindings</h3> <p>类型: <code>boolean</code></p> <p>命令: <code>--generatedCode.constBindings/--no-generatedCode.constBindings</code></p> <p>默认：<code>false</code></p> <p>这将在某些地方和帮助函数中使用<code>const</code>而不是<code>var</code>。由于块的作用域，这将允许 Rollup 生成更有效的帮助程序。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// input</span>
<span class="token keyword">export</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token string">'external'</span><span class="token punctuation">;</span>

<span class="token comment">// cjs output with constBindings: false</span>
<span class="token keyword">var</span> external <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'external'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>external<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">k</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>k <span class="token operator">!==</span> <span class="token string">'default'</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>exports<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span>
    Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>exports<span class="token punctuation">,</span> k<span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">enumerable</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> external<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// cjs output with constBindings: true</span>
<span class="token keyword">const</span> external <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'external'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> k <span class="token keyword">in</span> external<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>k <span class="token operator">!==</span> <span class="token string">'default'</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>exports<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span>
    Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>exports<span class="token punctuation">,</span> k<span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">enumerable</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> external<span class="token punctuation">[</span>k<span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="output-generatedcode-objectshorthand"><a href="#output-generatedcode-objectshorthand" class="header-anchor">#</a> output.generatedCode.objectShorthand</h3> <p>类型: <code>boolean</code></p> <p>命令: <code>--generatedCode.objectShorthand/--no-generatedCode.objectShorthand</code></p> <p>默认：<code>false</code></p> <p>当属性名与值匹配时，允许在对象中使用简写符号。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// input</span>
<span class="token keyword">const</span> foo <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span> foo<span class="token punctuation">,</span> foo <span class="token keyword">as</span> bar <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// system output with objectShorthand: false</span>
System<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token string">'bundle'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">exports</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token string">'use strict'</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">execute</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> foo <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
      <span class="token function">exports</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">foo</span><span class="token operator">:</span> foo<span class="token punctuation">,</span> <span class="token literal-property property">bar</span><span class="token operator">:</span> foo <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// system output with objectShorthand: true</span>
System<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token string">'bundle'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">exports</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token string">'use strict'</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">execute</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> foo <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
      <span class="token function">exports</span><span class="token punctuation">(</span><span class="token punctuation">{</span> foo<span class="token punctuation">,</span> <span class="token literal-property property">bar</span><span class="token operator">:</span> foo <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="output-generatedcode-preset"><a href="#output-generatedcode-preset" class="header-anchor">#</a> output.generatedCode.preset</h3> <p>类型: <code>&quot;es5&quot; | &quot;es2015&quot;</code></p> <p>命令: <code>--generatedCode &lt;value&gt;</code></p> <p>允许在覆盖一些选项时选择上面列出的预置之一。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  <span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">generatedCode</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">preset</span><span class="token operator">:</span> <span class="token string">'es2015'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">arrowFunctions</span><span class="token operator">:</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="output-generatedcode-reservednamesasprops"><a href="#output-generatedcode-reservednamesasprops" class="header-anchor">#</a> output.generatedCode.reservedNamesAsProps</h3> <p>类型: <code>boolean</code></p> <p>命令: <code>--generatedCode.reservedNamesAsProps/--no-generatedCode.reservedNamesAsProps</code></p> <p>默认：<code>false</code></p> <p>确定像“default”这样的保留字是否可以在不使用引号的情况下用作属性名。这将使生成的代码的语法符合 ES3。但是请注意，为了完全符合 ES3，你可能还需要填充一些内置函数，比如<code>Object.keys</code>或<code>Array.prototype.forEach</code>。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// input</span>
<span class="token keyword">const</span> foo <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span> foo <span class="token keyword">as</span> <span class="token keyword">void</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// cjs output with reservedNamesAsProps: false</span>
Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>exports<span class="token punctuation">,</span> <span class="token string">'__esModule'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> foo <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

exports<span class="token punctuation">[</span><span class="token string">'void'</span><span class="token punctuation">]</span> <span class="token operator">=</span> foo<span class="token punctuation">;</span>

<span class="token comment">// cjs output with reservedNamesAsProps: true</span>
Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>exports<span class="token punctuation">,</span> <span class="token string">'__esModule'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> foo <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

exports<span class="token punctuation">.</span>void <span class="token operator">=</span> foo<span class="token punctuation">;</span>
</code></pre></div><h3 id="output-generatedcode-symbols"><a href="#output-generatedcode-symbols" class="header-anchor">#</a> output.generatedCode.symbols</h3> <p>类型: <code>boolean</code></p> <p>命令: <code>--generatedCode.symbols/--no-generatedCode.symbols</code></p> <p>默认：<code>false</code></p> <p>是否允许在自动生成的代码段中使用<code>Symbol</code>。目前，这只是控制具有<code>Symbol.toStringTag</code>属性的命名空间设置为<code>Module</code>的正确值，这意味着对于命名空间来说，<code>String(namespace)</code>会记录<code>[object Module]</code>。这同样用于某些库和框架的特征检测。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// input</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> foo <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">;</span>

<span class="token comment">// cjs output with symbols: false</span>
Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>exports<span class="token punctuation">,</span> <span class="token string">'__esModule'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> foo <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">;</span>

exports<span class="token punctuation">.</span>foo <span class="token operator">=</span> foo<span class="token punctuation">;</span>

<span class="token comment">// cjs output with symbols: true</span>
Object<span class="token punctuation">.</span><span class="token function">defineProperties</span><span class="token punctuation">(</span>exports<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">__esModule</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>toStringTag<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">'Module'</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> foo <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">;</span>

exports<span class="token punctuation">.</span>foo <span class="token operator">=</span> foo<span class="token punctuation">;</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">注意</p> <p>示例中的<code>__esModule</code>标志可以通过<a href="">output.esModule</a>选项来阻止。</p></div> <h2 id="output-hoisttransitiveimports"><a href="#output-hoisttransitiveimports" class="header-anchor">#</a> output.hoistTransitiveImports</h2> <p>类型: <code>boolean</code></p> <p>命令: <code>--hoistTransitiveImports/--no-hoistTransitiveImports</code></p> <p>默认：<code>true</code></p> <p>默认当创建多个块时，入口块的递归导入将作为空导入被添加到入口块中。有关详细信息和背景信息，请参阅<a href="https://rollupjs.org/guide/en/#why-do-additional-imports-turn-up-in-my-entry-chunks-when-code-splitting" target="_blank" rel="noopener noreferrer">&quot;Why do additional imports turn up in my entry chunks when code-splitting?&quot;<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 。将此选项设置为<code>false</code>将禁用此行为。使用<a href="">output.preserveModules</a> 选项时会忽略此选项，导入将永远不会被提升。</p> <h2 id="output-inlinedynamicimports"><a href="#output-inlinedynamicimports" class="header-anchor">#</a> output.inlineDynamicImports</h2> <p>类型: <code>boolean</code></p> <p>命令: <code>--inlineDynamicImports/--no-inlineDynamicImports</code></p> <p>默认：<code>false</code></p> <p>这将使用内联动态导入，而不是创建新的块来创建单个包。只有在提供单个输入时才可以使用。注意，这将改变执行顺序：如果动态导入是内联的，则只动态导入的模块将立即执行。</p> <h2 id="output-interop"><a href="#output-interop" class="header-anchor">#</a> output.interop</h2> <p>类型: <code>&quot;auto&quot; | &quot;esModule&quot; | &quot;default&quot; | &quot;defaultOnly&quot; | boolean | ((id: string) =&gt; &quot;auto&quot; | &quot;esModule&quot; | &quot;default&quot; | &quot;defaultOnly&quot; | boolean)</code></p> <p>命令: <code>--interop &lt;value&gt;</code></p> <p>默认：<code>true</code></p> <p>控制 Rollup 如何处理 default、namespace 和来自格式类似于 CommonJS 这种没有官方支持这些概念的外部依赖的动态导入的方式。请注意，即使<code>true</code>是当前的默认值，该值已被弃用，并将在 Rollup 的下一个主要版本中被<code>“auto”</code>替换。详情参阅<a href="https://rollupjs.org/guide/en/#outputinterop" target="_blank" rel="noopener noreferrer">output.interop<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <h2 id="output-intro-output-outro"><a href="#output-intro-output-outro" class="header-anchor">#</a> output.intro/output.outro</h2> <p>类型: <code>string | (() =&gt; string | Promise&lt;string&gt;)</code></p> <p>命令: <code>--intro/--outro &lt;text&gt;</code></p> <p>类似于<a href="#output-banner-output-footer">output.banner/output.footer</a>，只是代码放在任何特定于格式的包装器中。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span><span class="token punctuation">,</span>
  <span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span><span class="token punctuation">,</span>
    <span class="token literal-property property">intro</span><span class="token operator">:</span> <span class="token string">'const ENVIRONMENT = &quot;production&quot;;'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="output-manualchunks"><a href="#output-manualchunks" class="header-anchor">#</a> output.manualChunks</h2> <p>类型: <code>{ [chunkAlias: string]: string[] } | ((id: string, {getModuleInfo, getModuleIds}) =&gt; string | void)</code></p> <p>允许创建自定义共享公共块。当使用对象形式时，每个属性表示一个包含列出的模块及其所有依赖项(如果它们是模块图的一部分)的块，除非它们已经在另一个手动块中。块的名称将由属性键确定。</p> <div class="custom-block tip"><p class="custom-block-title">注意</p> <p>列出的模块本身不一定要成为模块图的一部分，如果您正在使用<code>@rollup/plugin-node-resolve</code>并从包中使用深度导入，这是很有用的。 例如</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token literal-property property">manualChunks</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">lodash</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'lodash'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>将把所有 lodash 模块放入一个手动块，即使你只使用从<code>'lodash/get'</code>导入表单的导入。</p></div> <p>当使用函数形式时，每个解析的模块 id 将被传递给函数。如果返回一个字符串，该模块及其所有依赖项将以给定的名称添加到手动块中。例如，这将创建一个包含<code>node_modules</code>中所有依赖项的<code>vendor</code>块:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">manualChunks</span><span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>id<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">'node_modules'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">'vendor'</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>请注意，如果在实际使用相应模块之前触发了副作用，手动块可能会改变应用程序的行为。</p> <p>当使用函数形式时，<code>manualChunks</code>将被传递一个对象作为第二个参数，其中包含函数<code>getModuleInfo</code>和<code>getModuleIds</code>，它们的工作方式与插件上下文中的<a href="https://rollupjs.org/guide/en/#thisgetmoduleinfo" target="_blank" rel="noopener noreferrer">this.getModuleInfo<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>和<a href="https://rollupjs.org/guide/en/#thisgetmoduleids" target="_blank" rel="noopener noreferrer">this.getModuleIds<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>相同。</p> <p>这可以用于根据模块在模块图中的位置动态确定模块应该放置到哪个手动块中。例如，考虑这样一个场景: 您有一组组件，每个组件动态地导入一组翻译后的字符串，即</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">getTranslatedStrings</span><span class="token punctuation">(</span><span class="token parameter">currentLanguage</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>currentLanguage<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token string">'en'</span><span class="token operator">:</span>
      <span class="token keyword">return</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'./foo.strings.en.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token string">'de'</span><span class="token operator">:</span>
      <span class="token keyword">return</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'./foo.strings.de.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>如果很多这样的组件一起使用,这将导致大量的动态的引入非常小的块。虽然我们知道所有语言文件(被同样的块引入的相同语言)将总是被一起使用，但是 Rollup 并不知道这一点。</p> <p>下面的代码将合并只有一个入口点使用的同一语言的所有文件:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">manualChunks</span><span class="token punctuation">(</span><span class="token parameter">id<span class="token punctuation">,</span> <span class="token punctuation">{</span> getModuleInfo <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> match <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">.*\.strings\.(\w+)\.js</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>match<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> language <span class="token operator">=</span> match<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// e.g. &quot;en&quot;</span>
    <span class="token keyword">const</span> dependentEntryPoints <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token comment">// we use a Set here so we handle each module at most once. This</span>
    <span class="token comment">// prevents infinite loops in case of circular dependencies</span>
    <span class="token keyword">const</span> idsToHandle <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token function">getModuleInfo</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">.</span>dynamicImporters<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> moduleId <span class="token keyword">of</span> idsToHandle<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> <span class="token punctuation">{</span> isEntry<span class="token punctuation">,</span> dynamicImporters<span class="token punctuation">,</span> importers <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">getModuleInfo</span><span class="token punctuation">(</span>moduleId<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>isEntry <span class="token operator">||</span> dynamicImporters<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> dependentEntryPoints<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>moduleId<span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token comment">// The Set iterator is intelligent enough to iterate over elements that</span>
      <span class="token comment">// are added during iteration</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> importerId <span class="token keyword">of</span> importers<span class="token punctuation">)</span> idsToHandle<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>importerId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// If there is a unique entry, we put it into a chunk based on the entry name</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>dependentEntryPoints<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>dependentEntryPoints<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.strings.</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>language<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// For multiple entries, we put it into a &quot;shared&quot; chunk</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>dependentEntryPoints<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">shared.strings.</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>language<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="output-minifyinternalexports"><a href="#output-minifyinternalexports" class="header-anchor">#</a> output.minifyInternalExports</h2> <p>类型: <code>boolean</code></p> <p>命令: <code>--minifyInternalExports/--no-minifyInternalExports</code></p> <p>默认：如果格式是<code>es</code>和<code>system</code>或者<code>output.compact</code>是<code>true</code>，则此选项默认为<code>true</code>，否则默认<code>false</code></p> <p>默认情况下，对于是<code>es</code>和<code>system</code>，或者如果<code>output.compact</code>是<code>true</code>, Rollup 将尝试将内部变量导出为单个字母变量，以便更好地缩小。</p> <p><strong>例如</strong></p> <p>输入:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// main.js</span>
<span class="token keyword">import</span> <span class="token string">'./lib.js'</span><span class="token punctuation">;</span>

<span class="token comment">// lib.js</span>
<span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'./dynamic.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> value <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">;</span>

<span class="token comment">// dynamic.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> value <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./lib.js'</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>带有<code>output.minifyInternalExports: true</code>的输出：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// main.js</span>
<span class="token keyword">import</span> <span class="token string">'./main-5532def0.js'</span><span class="token punctuation">;</span>

<span class="token comment">// main-5532def0.js</span>
<span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'./dynamic-402de2f0.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> importantValue <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token punctuation">{</span> importantValue <span class="token keyword">as</span> i <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// dynamic-402de2f0.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> i <span class="token keyword">as</span> importantValue <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./main-5532def0.js'</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>importantValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>带有<code>output.minifyInternalExports: false</code>的输出：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// main.js</span>
<span class="token keyword">import</span> <span class="token string">'./main-5532def0.js'</span><span class="token punctuation">;</span>

<span class="token comment">// main-5532def0.js</span>
<span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'./dynamic-402de2f0.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> importantValue <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token punctuation">{</span> importantValue <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// dynamic-402de2f0.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> importantValue <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./main-5532def0.js'</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>importantValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>尽管将这个选项设置为<code>true</code>会使输出变大，但如果使用了一个压缩工具，它实际上会使输出变小。 在这种情况下，<code>export{importantValue as i}</code>可以变成<code>export{a as i}</code>甚至<code>export{i}</code>，而在其他情况下，它会生成<code>export{a as importantValue}</code>，因为压缩工具通常不会改变导出签名。</p> <h2 id="output-paths"><a href="#output-paths" class="header-anchor">#</a> output.paths</h2> <p>类型: <code>{ [id: string]: string } | ((id: string) =&gt; string)</code></p> <p>将外部模块 id 映射到路径。外部 id 是无法解析的 id 或<a href="/rollup/options/coreFunctionality.html#external">external</a>选项显式提供的 id。由<code>output.paths</code>提供的路径将取代模块 ID 在生成的包中使用，这允许你，例如，从 CDN 加载依赖项:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// app.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> selectAll <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'d3'</span><span class="token punctuation">;</span>
<span class="token function">selectAll</span><span class="token punctuation">(</span><span class="token string">'p'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">style</span><span class="token punctuation">(</span><span class="token string">'color'</span><span class="token punctuation">,</span> <span class="token string">'purple'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ...</span>

<span class="token comment">// rollup.config.js</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">input</span><span class="token operator">:</span> <span class="token string">'app.js'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">external</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'d3'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">file</span><span class="token operator">:</span> <span class="token string">'bundle.js'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">format</span><span class="token operator">:</span> <span class="token string">'amd'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">paths</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">d3</span><span class="token operator">:</span> <span class="token string">'https://d3js.org/d3.v4.min'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// bundle.js</span>
<span class="token function">define</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'https://d3js.org/d3.v4.min'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">d3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  d3<span class="token punctuation">.</span><span class="token function">selectAll</span><span class="token punctuation">(</span><span class="token string">'p'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">style</span><span class="token punctuation">(</span><span class="token string">'color'</span><span class="token punctuation">,</span> <span class="token string">'purple'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/vincentZhang92/vincentZhang92.github.io/edit/docs/docs/rollup/options/advancedFunctionality.md" target="_blank" rel="noopener noreferrer">帮助VincentZhang92改善此页面！</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2022-05-05 17:57:47</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/rollup/options/coreFunctionality.html" class="prev">
        核心配置
      </a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.b0589c77.js" defer></script><script src="/assets/js/2.c0366890.js" defer></script><script src="/assets/js/20.ef8e6329.js" defer></script>
  </body>
</html>
